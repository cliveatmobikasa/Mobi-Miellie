!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SingleWidgetManager=t():e.SingleWidgetManager=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SEARCH_REQUEST="SEARCH_REQUEST",e.SEARCH_FAILED="SEARCH_FAILED",e.COLLECT_POINT_SELECTED="COLLECT_POINT_SELECTED",e.COLLECT_POINT_UNSELECTED="COLLECT_POINT_UNSELECTED",e.COLLECT_POINT_CONFIRMED="COLLECT_POINT_CONFIRMED",e.BOOT_FAILED="BOOT_FAILED"}(t.SubscribeTopic||(t.SubscribeTopic={})),function(e){e.INVALIDATE_MAP_SIZE="INVALIDATE_MAP_SIZE",e.MAP_SEARCH_QUERY="MAP_SEARCH_QUERY",e.MAP_LATLNG_QUERY="MAP_LATLNG_QUERY",e.RESET_STATE="RESET_STATE",e.SHOW_STATIC_MAP="SHOW_STATIC_MAP",e.SHOW_INFORMATION="SHOW_INFORMATION",e.SET_CONFIGURATION="SET_CONFIGURATION"}(t.EmitTopic||(t.EmitTopic={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.default=n.SingleWidgetManager},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),s=r(5),o=r(8),a=r(9),u=r(10),c=function(){function e(e){void 0===e&&(e={});var t=new s.default,r={container:document.body,iframeParams:{},iframeUrl:null,isDebug:!1};if(void 0!==e.container&&!(e.container instanceof Element))throw Error(u.ERROR_MESSAGES.CONTAINER_NOT_ELEMENT);var c=n(n({},r),e||{});if("string"!=typeof c.iframeUrl)throw Error(u.ERROR_MESSAGES.IFRAME_URL_REQUIRED);try{new URL(c.iframeUrl)}catch(e){throw Error(u.ERROR_MESSAGES.URL_PARSE_ERROR)}var E=new URL(c.iframeUrl),f=new o.default(c.iframeParams,E.origin,E.pathname).getIframeEl(),h=new i.default(t,f,E.origin,c.isDebug);if(!f)throw Error(u.ERROR_MESSAGES.IFRAME_NOT_FOUND);if(!c.container)throw Error(u.ERROR_MESSAGES.CONTAINER_NOT_FOUND);c.container.append(f);var l={events:n(n({},t.getConsumerMethods()),{emit:function(e,t){return h.queueMessageToIframe({topic:e,message:t}),this}}),topics:a.windowTopicsObject};this.events=l.events,this.topics=l.topics}return e.meta={commitHash:'a77062a',version:'1.3.3'},e.iframeUrls={SANDBOX:"https://sandbox.frame.hub-box.com",PRODUCTION:"https://frame.hub-box.com"},e}();t.SingleWidgetManager=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(4),s=function(){function e(e,t,r,n){void 0===n&&(n=!1),this.eventManager=e,this.iframeEl=t,this.iframeOrigin=r,this.isDebug=n,this.eventManager=e,this.iframeEl=t,this.iframeOrigin=r,this.isDebug=n,this.channel=new MessageChannel,this.numOfHandshakeAttempts=0,this.maxNumOfHandshakeAttempts=5,this.intervalTime=500,this.messageQueue=[],this.handshakeReceived=!1,this.setUpHandshakeOnLoad(),this.setUpMessageListener()}return e.prototype.sendMessageToIframeWindow=function(e){if(!this.iframeEl||!this.iframeEl.contentWindow)throw Error(i.ERROR_MESSAGES.IFRAME_NOT_FOUND);try{this.iframeEl.contentWindow.postMessage(e,this.iframeOrigin,[this.channel.port2])}catch(e){this.isDebug&&console.warn("Post message failed. "+(this.maxNumOfHandshakeAttempts-this.numOfHandshakeAttempts)+" attempts left")}},e.prototype.setUpMessageListener=function(){this.channel.port1.onmessage=this.handShakeReplyCallback.bind(this)},e.prototype.queueMessageToIframe=function(e){this.handshakeReceived?this.channel.port1.postMessage(e):this.messageQueue.push(e)},e.prototype.performHandshake=function(){if(!this.responseInterval)throw Error(i.ERROR_MESSAGES.INTERVAL_NOT_DEFINED);if(this.numOfHandshakeAttempts>=this.maxNumOfHandshakeAttempts)return clearInterval(this.responseInterval),void this.eventManager.emit(n.SubscribeTopic.BOOT_FAILED,{error:i.BOOT_FAIL_CODES.EXCEEDED_MAX_HANDSHAKES});this.numOfHandshakeAttempts++,this.sendMessageToIframeWindow(i.HANDSHAKE_MESSAGE)},e.prototype.setUpHandshakeOnLoad=function(){var e=this;this.iframeEl.addEventListener("load",function(){e.responseInterval=setInterval(e.performHandshake.bind(e),e.intervalTime),e.performHandshake()}.bind(this))},e.prototype.handShakeReplyCallback=function(e){var t=this;if(e.data===i.HANDSHAKE_REPLY_MESSAGE){if(this.handshakeReceived=!0,!this.responseInterval)throw Error(i.ERROR_MESSAGES.INTERVAL_NOT_DEFINED);clearInterval(this.responseInterval),this.channel.port1.onmessage=this.messageCallback.bind(this),this.messageQueue.forEach((function(e){t.channel.port1.postMessage(e)}))}},e.prototype.messageCallback=function(e){var t=e.data;if(!(t.topic in n.SubscribeTopic))throw Error(i.ERROR_MESSAGES.TOPIC_NOT_FOUND);this.eventManager.emit(t.topic,t.message)},e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERROR_MESSAGES={IFRAME_NOT_FOUND:"The Iframe cannot be found in the DOM",TOPIC_NOT_FOUND:"The Topic sent in iframe message cannot be found",PROBLEM_PARSING_MESSAGE:"There was a problem parsing the message",INTERVAL_NOT_DEFINED:"Response Interval is not defined",EXCEEDED_MAX_HANDSHAKES:"Exceeded max number of handshake retries"},t.BOOT_FAIL_CODES={EXCEEDED_MAX_HANDSHAKES:"EXCEEDED_MAX_HANDSHAKES"},t.HANDSHAKE_MESSAGE="handshake",t.HANDSHAKE_REPLY_MESSAGE="handshake-reply"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(6),s=r(7),o=function(){function e(t){void 0===t&&(t=e.getEventTargetWithFallback()),this.target=t,this.subscribedEvents=Object.keys(n.SubscribeTopic).reduce((function(e,t){return e[t]=[],e}),{}),this.target=t}return e.prototype.subscribe=function(e,t,r){var s=this;if(void 0===r&&(r=!1),e in n.SubscribeTopic){var o=function(r){return t({topic:e,message:r.detail})};return this.target.addEventListener(e,o,{once:r}),this.subscribedEvents[e].push([t,function(){return s.target.removeEventListener(e,o)}]),this}throw Error(i.TOPIC_ERROR_MESSAGE)},e.prototype.unsubscribe=function(e,t){if(!(e in n.SubscribeTopic))throw Error(i.TOPIC_ERROR_MESSAGE);if(t){var r=this.subscribedEvents[e].find((function(e){return e[0]===t}));r&&r[1]&&r[1]()}else this.subscribedEvents[e].forEach((function(e){e&&e[1]&&e[1]()}));return this},e.prototype.takeFirst=function(e,t){if(e in n.SubscribeTopic)return this.subscribe(e,t,!0);throw Error(i.TOPIC_ERROR_MESSAGE)},e.prototype.emit=function(e,t){if(!(e in n.SubscribeTopic))throw Error(i.TOPIC_ERROR_MESSAGE);return this.target.dispatchEvent(new CustomEvent(e,{detail:t})),this},e.prototype.getConsumerMethods=function(){return s.consumerMethodsFactory(this)},e.getEventTargetWithFallback=function(){var e;try{e=new EventTarget}catch(t){e=document.createElement("div")}return e},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TOPIC_ERROR_MESSAGE="Topic cannot be found"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.consumerMethodsFactory=function(e){return{subscribe:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.subscribe.apply(e,t),this},unsubscribe:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.unsubscribe.apply(e,t),this},takeFirst:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.takeFirst.apply(e,t),this}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r){void 0===e&&(e={}),this.srcParameters=e,this.iframeOrigin=t,this.iframePath=r,this.iframeOrigin=t,this.srcParameters=e,this.iframeEl=document.createElement("iframe"),this.setIframeSrc(),this.setAllowGeoLocation(),this.setNoScrolling(),this.setNoFrameBorder()}return e.prototype.setIframeSrc=function(){this.hasKeys(this.srcParameters)?this.iframeEl.src=""+this.iframeOrigin+this.iframePath+"?"+this.serializeSrcParameters():this.iframeEl.src=this.iframeOrigin+this.iframePath},e.prototype.setAllowGeoLocation=function(){this.getIframeEl().setAttribute("allow","geolocation")},e.prototype.setNoScrolling=function(){this.getIframeEl().setAttribute("scrolling","no")},e.prototype.setNoFrameBorder=function(){this.getIframeEl().setAttribute("frameBorder","0")},e.prototype.getIframeEl=function(){return this.iframeEl},e.prototype.getIframeOrigin=function(){return this.iframeOrigin},e.prototype.serializeSrcParameters=function(){return e.serialise(this.srcParameters)},e.serialise=function(e){return Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){return"object"==typeof e[t]?[t,JSON.stringify(e[t])].map(encodeURIComponent).join("="):[t,e[t]].map(encodeURIComponent).join("=")})).join("&")},e.prototype.hasKeys=function(e){return!!Object.keys(e).length},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.windowTopicsObject={subscribe:Object.keys(n.SubscribeTopic).reduce((function(e,t){return e[t]=t,e}),{}),emit:Object.keys(n.EmitTopic).reduce((function(e,t){return e[t]=t,e}),{})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERROR_MESSAGES={CONTAINER_NOT_FOUND:"Could not find container in the DOM. Iframe could not be appended",IFRAME_NOT_FOUND:"Cannot find iframe element",CONTAINER_NOT_ELEMENT:"Container should to be a DOM element",URL_PARSE_ERROR:"Unable to parse iframe url",IFRAME_URL_REQUIRED:"Iframe url option is a required option"}}]).default}));